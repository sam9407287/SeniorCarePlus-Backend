# SeniorCarePlus Backend

## ğŸ¥ è€äººç…§è­·ç³»çµ±å¾Œç«¯æœå‹™

åŸºæ–¼ Kotlin + Ktor æ§‹å»ºçš„è€äººç…§è­·IoTæ•¸æ“šæ”¶é›†èˆ‡ç®¡ç†ç³»çµ±ï¼Œæ”¯æ´å¯¦æ™‚å¥åº·ç›£æ¸¬ã€ä½ç½®è¿½è¹¤å’Œè­¦å ±ç®¡ç†ã€‚

---

## ğŸ“Š åŠŸèƒ½ç‹€æ…‹ç¸½è¦½

### âœ… **å·²å®ŒæˆåŠŸèƒ½**

| åŠŸèƒ½æ¨¡çµ„ | ç‹€æ…‹ | æè¿° |
|---------|------|------|
| ğŸ—ï¸ **MQTTæœå‹™** | âœ… é‹è¡Œä¸­ | é€£æ¥HiveMQé›²ç«¯æœå‹™å™¨ï¼Œæ¥æ”¶IoTè¨­å‚™æ•¸æ“š |
| ğŸ“ **UWBä½ç½®è¿½è¹¤** | âœ… æ´»èºæ”¶é›† | å¯¦æ™‚æ¥æ”¶UWBæ¨™ç±¤ä½ç½®æ•¸æ“šï¼Œ6å¤©ç´¯ç©129MB |
| ğŸ’¾ **H2æ•¸æ“šåº«** | âœ… ç©©å®šé‹è¡Œ | æ–‡ä»¶å‹æ•¸æ“šåº«ï¼Œæ•¸æ“šæŒä¹…åŒ–å­˜å„² |
| ğŸ”„ **æ•¸æ“šè§£æå¼•æ“** | âœ… æ­£å¸¸ | è‡ªå‹•è§£æUWB JSONæ ¼å¼ï¼Œæ¨™ç±¤IDæ˜ å°„ |
| ğŸ¥ **æ‚£è€…ç®¡ç†** | âœ… å®Œæˆ | æ‚£è€…ä¿¡æ¯CRUDï¼Œè¨­å‚™é—œè¯ç®¡ç† |
| ğŸ“Š **REST API** | âœ… å¯ç”¨ | `/api/patients`, `/health` ç«¯é» |
| ğŸ” **WebSocketæ”¯æŒ** | âœ… å¯¦ç¾ | å¯¦æ™‚æ•¸æ“šæµæ¨é€ |
| ğŸ“ **æ—¥èªŒç³»çµ±** | âœ… å®Œæ•´ | è©³ç´°çš„æ“ä½œå’ŒéŒ¯èª¤æ—¥èªŒ |

### ğŸ”§ **ç³»çµ±å°±ç·’ï¼Œå¾…è¨­å‚™æ¥å…¥**

| åŠŸèƒ½æ¨¡çµ„ | ç‹€æ…‹ | éœ€æ±‚ |
|---------|------|------|
| â¤ï¸ **å¿ƒç‡ç›£æ¸¬** | ğŸ”§ å¾…æ¥å…¥ | éœ€è¦å¿ƒç‡æ„Ÿæ¸¬å™¨/æ‰‹ç’°è¨­å‚™ |
| ğŸŒ¡ï¸ **é«”æº«ç›£æ¸¬** | ğŸ”§ å¾…æ¥å…¥ | éœ€è¦é«”æº«è²¼ç‰‡/æ„Ÿæ¸¬å™¨ |
| ğŸ¼ **å°¿å¸ƒç›£æ¸¬** | ğŸ”§ å¾…æ¥å…¥ | éœ€è¦æ™ºèƒ½å°¿å¸ƒ/æ¿•åº¦æ„Ÿæ¸¬å™¨ |
| ğŸš¨ **ç·Šæ€¥è­¦å ±** | ğŸ”§ å¾…æ¥å…¥ | éœ€è¦ç·Šæ€¥æŒ‰éˆ•/è·Œå€’åµæ¸¬å™¨ |

### âš ï¸ **å·²çŸ¥å•é¡Œèˆ‡é™åˆ¶**

| å•é¡Œé¡åˆ¥ | æè¿° | å½±éŸ¿ç­‰ç´š | è§£æ±ºæ–¹æ¡ˆ |
|---------|------|---------|---------|
| ğŸ˜ **PostgreSQLé€£æ¥** | æœ¬åœ°PostgreSQLæœªå®‰è£ | ğŸŸ¡ ä¸­ç­‰ | å®‰è£PostgreSQLæˆ–ä½¿ç”¨Supabase |
| ğŸ”’ **SSLè­‰æ›¸** | ä½¿ç”¨TrustAll SSLé…ç½® | ğŸŸ¡ ä¸­ç­‰ | ç”Ÿç”¢ç’°å¢ƒéœ€è¦æ­£å¼è­‰æ›¸ |
| ğŸ“ˆ **ä¸¦ç™¼æ€§èƒ½** | H2æ•¸æ“šåº«ä¸¦ç™¼é™åˆ¶ | ğŸŸ¢ ä½ | è€ƒæ…®é·ç§»åˆ°PostgreSQL |
| ğŸ·ï¸ **æ¨™ç±¤æ˜ å°„** | ç¡¬ç·¨ç¢¼UWBæ¨™ç±¤ID | ğŸŸ¢ ä½ | å¯¦ç¾å‹•æ…‹è¨­å‚™è¨»å†Š |

---

## ğŸ—ï¸ æ•¸æ“šåº«æ¶æ§‹

### ğŸ“‹ **æ•¸æ“šåº«æ¶æ§‹åœ–**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   SeniorCarePlus Database Schema                â”‚
â”‚                        (H2 File Database)                      â”‚
â”‚                     File: ./data/seniorcareplus.mv.db          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    1:N    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Patients     â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ HealthRecords   â”‚
â”‚                 â”‚           â”‚                 â”‚
â”‚ â€¢ id (PK)       â”‚           â”‚ â€¢ id (PK)       â”‚
â”‚ â€¢ name          â”‚           â”‚ â€¢ patient_id (FK)â”‚
â”‚ â€¢ room          â”‚           â”‚ â€¢ data_type     â”‚
â”‚ â€¢ device_id â­   â”‚           â”‚ â€¢ value (JSON)  â”‚
â”‚ â€¢ age           â”‚           â”‚ â€¢ device_id     â”‚
â”‚ â€¢ gender        â”‚           â”‚ â€¢ quality       â”‚
â”‚ â€¢ emergency_contact         â”‚ â€¢ unit          â”‚
â”‚ â€¢ created_at    â”‚           â”‚ â€¢ timestamp     â”‚
â”‚ â€¢ updated_at    â”‚           â”‚ â€¢ created_at    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
        â”‚
        â”‚ 1:N
        â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ LocationRecords â”‚           â”‚     Alerts      â”‚
â”‚                 â”‚           â”‚                 â”‚
â”‚ â€¢ id (PK)       â”‚    1:N    â”‚ â€¢ id (PK)       â”‚
â”‚ â€¢ patient_id (FK)â”‚â—„â”€â”€â”€â”€â”€â”€â”€â”€â”€â–ºâ”‚ â€¢ patient_id (FK)â”‚
â”‚ â€¢ x, y, z ğŸ“     â”‚           â”‚ â€¢ alert_type    â”‚
â”‚ â€¢ accuracy      â”‚           â”‚ â€¢ title         â”‚
â”‚ â€¢ area          â”‚           â”‚ â€¢ message       â”‚
â”‚ â€¢ device_id     â”‚           â”‚ â€¢ severity      â”‚
â”‚ â€¢ timestamp     â”‚           â”‚ â€¢ status        â”‚
â”‚ â€¢ created_at    â”‚           â”‚ â€¢ device_id     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â€¢ triggered_at  â”‚
        â–²                     â”‚ â€¢ acknowledged_atâ”‚
        â”‚                     â”‚ â€¢ resolved_at   â”‚
     ğŸ“¡ UWB Data              â”‚ â€¢ created_at    â”‚
    (129MB/6days)             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                      â–²
                                      â”‚ 1:N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”‚
â”‚    Devices      â”‚           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                 â”‚           â”‚  RemindersTable â”‚
â”‚ â€¢ id (PK)       â”‚           â”‚                 â”‚
â”‚ â€¢ device_id â­   â”‚           â”‚ â€¢ id (PK)       â”‚
â”‚ â€¢ device_type   â”‚           â”‚ â€¢ patient_id (FK)â”‚
â”‚ â€¢ status        â”‚           â”‚ â€¢ title         â”‚
â”‚ â€¢ last_seen     â”‚           â”‚ â€¢ description   â”‚
â”‚ â€¢ battery_level â”‚           â”‚ â€¢ reminder_type â”‚
â”‚ â€¢ firmware_version          â”‚ â€¢ scheduled_timeâ”‚
â”‚ â€¢ created_at    â”‚           â”‚ â€¢ is_completed  â”‚
â”‚ â€¢ updated_at    â”‚           â”‚ â€¢ completed_at  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚ â€¢ created_at    â”‚
                              â”‚ â€¢ updated_at    â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”‘ **æ ¸å¿ƒè¡¨èªªæ˜**

**æ‚£è€…è¡¨ (Patients)**
- ç³»çµ±æ ¸å¿ƒå¯¦é«”ï¼Œå­˜å„²è€äººåŸºæœ¬ä¿¡æ¯
- `device_id` å­—æ®µé€£æ¥å„ç¨®IoTè¨­å‚™

**ä½ç½®è¨˜éŒ„è¡¨ (LocationRecords)**  
- å¯¦æ™‚UWBä½ç½®è¿½è¹¤æ•¸æ“š
- ç›®å‰ç´¯ç©ï¼š129MBæ•¸æ“š (6å¤©é€£çºŒæ”¶é›†)
- åŒ…å«3Dåæ¨™ã€ç²¾åº¦ã€å€åŸŸä¿¡æ¯

**å¥åº·è¨˜éŒ„è¡¨ (HealthRecords)**
- é€šç”¨å¥åº·æ•¸æ“šå­˜å„² (JSONæ ¼å¼)
- æ”¯æŒï¼šå¿ƒç‡ã€é«”æº«ã€å°¿å¸ƒç‹€æ…‹ç­‰

**è­¦å ±è¡¨ (Alerts)**
- ç·Šæ€¥äº‹ä»¶ç®¡ç†
- æ”¯æŒï¼šemergency/warning/info ä¸‰ç´šè­¦å ±

---

## ğŸš€ å¿«é€Ÿé–‹å§‹

### ğŸ“‹ **ç³»çµ±éœ€æ±‚**

- Java 17+
- Kotlin 1.9+
- Gradle 8.4+

### ğŸ”§ **å®‰è£æ­¥é©Ÿ**

1. **å…‹éš†é …ç›®**
```bash
git clone https://github.com/sam9407287/SeniorCarePlus-Backend.git
cd SeniorCarePlus-Backend
```

2. **å•Ÿå‹•æœå‹™**
```bash
./gradlew run
```

3. **é©—è­‰æœå‹™**
```bash
curl http://localhost:8080/health
```

### ğŸŒ **APIç«¯é»**

| ç«¯é» | æ–¹æ³• | æè¿° |
|------|------|------|
| `/health` | GET | æœå‹™å¥åº·æª¢æŸ¥ |
| `/api/patients` | GET | ç²å–æ‚£è€…åˆ—è¡¨ |
| `/api/health/{deviceId}` | GET | ç²å–æŒ‡å®šè¨­å‚™å¥åº·æ•¸æ“š |
| `/api/alerts` | GET | ç²å–è­¦å ±åˆ—è¡¨ |
| `/ws/health` | WebSocket | å¯¦æ™‚å¥åº·æ•¸æ“šæµ |

---

## ğŸ“Š **æ•¸æ“šæ”¶é›†çµ±è¨ˆ**

### ğŸ“ˆ **ç•¶å‰æ•¸æ“šè¦æ¨¡**

- **æ”¶é›†æ™‚é–“**: 2025/07/14 12:17 - 2025/07/20 07:10  
- **æŒçºŒå¤©æ•¸**: 6å¤©ä¸é–“æ–·  
- **ä½ç½®æ•¸æ“š**: 129MB (ç´„21MB/å¤©)  
- **è¨˜éŒ„é »ç‡**: æ¯ç§’å¤šæ¬¡UWBä½ç½®æ›´æ–°  
- **æ¨™ç±¤æ•¸é‡**: 2å€‹æ´»èºUWBæ¨™ç±¤  

### ğŸ·ï¸ **æ¨™ç±¤æ˜ å°„**

| æ¨™ç±¤ID | 16é€²åˆ¶ | å°æ‡‰æ‚£è€… | ç‹€æ…‹ |
|--------|--------|----------|------|
| 1770 | 0x06EA | device_001 | âœ… æ´»èº |
| 13402 | 0x345A | device_002 | âœ… æ´»èº |

---

## ğŸ”® **æœªä¾†è¦åŠƒ**

### ğŸ¯ **çŸ­æœŸç›®æ¨™ (1-2é€±)**

- [ ] PostgreSQLé›²ç«¯æ•¸æ“šåº«é›†æˆ
- [ ] å¿ƒç‡ç›£æ¸¬è¨­å‚™æ¥å…¥æ¸¬è©¦
- [ ] APIæ–‡æª”å®Œå–„ (Swagger)
- [ ] å–®å…ƒæ¸¬è©¦è¦†è“‹

### ğŸš€ **ä¸­æœŸç›®æ¨™ (1-2å€‹æœˆ)**

- [ ] å¯¦æ™‚è­¦å ±æ¨é€ç³»çµ±
- [ ] æ•¸æ“šåˆ†æå„€è¡¨æ¿
- [ ] ç§»å‹•ç«¯ç®¡ç†Appé›†æˆ
- [ ] å¤šç§Ÿæˆ¶æ”¯æŒ

### ğŸŒŸ **é•·æœŸé¡˜æ™¯ (3-6å€‹æœˆ)**

- [ ] AIå¥åº·é è­¦ç³»çµ±
- [ ] å®¶å±¬é€šçŸ¥ç³»çµ±
- [ ] é†«ç™‚è¨˜éŒ„é›†æˆ
- [ ] è·¨æ©Ÿæ§‹æ•¸æ“šå…±äº«

---

## ğŸ› ï¸ **æŠ€è¡“æ£§**

### ğŸ”§ **å¾Œç«¯æŠ€è¡“**

- **Framework**: Ktor 2.3.5
- **Language**: Kotlin 1.9.10  
- **Database**: H2 (æ–‡ä»¶å‹) / PostgreSQL (é›²ç«¯)
- **ORM**: Exposed
- **MQTT**: Eclipse Paho
- **Build Tool**: Gradle 8.4

### ğŸ“¡ **IoTæŠ€è¡“**

- **ä½ç½®è¿½è¹¤**: UWB (Ultra-Wideband) æŠ€è¡“
- **é€šè¨Šå”è­°**: MQTT over WebSocket (SSL)
- **é›²ç«¯æœå‹™**: HiveMQ Cloud
- **æ•¸æ“šæ ¼å¼**: JSON

---

## ğŸ“ **è¯çµ¡ä¿¡æ¯**

- **Project**: SeniorCarePlus IoT Backend
- **GitHub**: https://github.com/sam9407287/SeniorCarePlus-Backend
- **Version**: 1.0.0
- **Last Updated**: 2025/07/20

---

## ğŸ“„ **æˆæ¬Š**

MIT License - è©³è¦‹ LICENSE æ–‡ä»¶